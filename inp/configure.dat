! All comments should be preceded by "!".
! Inline comments should be separated from the content by at least one blank
! space.
&grid_configure
  grid_config%rmin = 0.5D0
  grid_config%rmax = 2D0
  grid_config%zmin = 0D0
  grid_config%zmax = 2D0
  grid_config%columnwise = .true.
  grid_config%ncol = 30
  grid_config%use_data_file_input = .false.
  grid_config%data_dir = './inp/'
  grid_config%data_filename = 'RADMC_density_temperature.dat'
  grid_config%analytical_to_use = 'Andrews'
  grid_config%interpolation_method = 'spline'
  grid_config%max_ratio_to_be_uniform = 2.0D0
  grid_config%max_val_considered = 1d15
  grid_config%min_val_considered = 1d4
  grid_config%very_small_len = 1D-6
  grid_config%smallest_cell_size = 1D-2
  grid_config%small_len_frac = 1D-4
/
&chemistry_configure
  chemsol_params%allow_stop_before_t_max     = .false.
  chemsol_params%dt_first_step               = 1D-7
  chemsol_params%t_max                       = 1D7
  chemsol_params%ratio_tstep                 = 1.1D0
  chemsol_params%max_runtime_allowed         = 300.0
  chemsol_params%RTOL                        = 1D-4
  chemsol_params%ATOL                        = 1D-40
  chemsol_params%mxstep_per_interval         = 6000
  chemsol_params%chem_files_dir              = './inp/'
  chemsol_params%filename_chemical_network   = 'rate06_dipole_reformated_again_withgrain.dat'
  chemsol_params%filename_initial_abundances = 'initial_condition_Garrod08_mod.dat'
  chemsol_params%filename_species_enthalpy   = 'Species_enthalpy.dat'
  chemsol_params%H2_form_use_moeq            = .false.
  chemsol_params%neutralize                  = .true.
  chemsol_params%flag_chem_evol_save         = .false.
/
&heating_cooling_configure
  ! When use_analytical_CII_OI is true, the two files will not be used.
  heating_cooling_config%use_analytical_CII_OI   = .true.
  heating_cooling_config%dir_transition_rates    = './inp/'
  heating_cooling_config%filename_Cplus          = 'C+.dat'
  heating_cooling_config%filename_OI             = 'Oatom.dat'
/
&montecarlo_configure
  mc_conf%nph                   = 100000      ! Divide total star luminosity into this number.
  mc_conf%nmax_cross            = 1999999999  ! Max num of cell crossing before any ab or sc
  mc_conf%nmax_encounter        = 1999999999  ! Max num of absor and scat events
  mc_conf%min_ang               = 0D0  ! Angle range of rays
  mc_conf%max_ang               = 15D0
  mc_conf%use_blackbody_star    = .false.
  mc_conf%savephoton            = .false.
  mc_conf%mc_dir_in             = './inp/'
  mc_conf%mc_dir_out            = 'mc/'
  mc_conf%fname_photons         = 'escaped_photons.dat'
  ! mc_conf%fname_dust            = 'dust_mixed.dat'
  mc_conf%fname_dust            = 'dust_mixed_largersize.dat'
  mc_conf%fname_water           = 'H2O.photoxs'
  mc_conf%fname_star            = 'tw_hya_spec_combined.dat'
/
&dustmix_configure
  dustmix_info%nmixture = 1  ! Number of mixtures you want to make
  dustmix_info%lam_min = 0.09D0  ! Minimum wavelength (micron) to be considered
  dustmix_info%lam_max = 1D3  ! Maximum ...
  !
  dustmix_info%mix(1)%id = 1  ! Mixture 1
  dustmix_info%mix(1)%nrawdust = 3  ! Number of raw material for mixing
  dustmix_info%mix(1)%rho = 3D0 ! Dust material density in g cm-3
  dustmix_info%mix(1)%dir = '/Users/fdu/Dropbox/work/protoplanetary_disk/inp/'
  dustmix_info%mix(1)%filenames(1) = 'suvSil_81'  ! Filename of raw material 1
  dustmix_info%mix(1)%filenames(2) = 'Gra_81'
  dustmix_info%mix(1)%filenames(3) = 'SiC_81'
  dustmix_info%mix(1)%weights(1) = 0.7D0  ! Weight of raw material 1
  dustmix_info%mix(1)%weights(2) = 0.2D0
  dustmix_info%mix(1)%weights(3) = 0.1D0
  !
  !dustmix_info%mix(2)%id = 2  ! Mixture 2
  !dustmix_info%mix(2)%nrawdust = 3
  !dustmix_info%mix(2)%dir = '/Users/fdu/Dropbox/work/protoplanetary_disk/inp/'
  !dustmix_info%mix(2)%filenames(1) = 'suvSil_81'
  !dustmix_info%mix(2)%filenames(2) = 'Gra_81'
  !dustmix_info%mix(2)%filenames(3) = 'SiC_81'
  !dustmix_info%mix(2)%weights(1) = 0.7D0
  !dustmix_info%mix(2)%weights(2) = 0.2D0
  !dustmix_info%mix(2)%weights(3) = 0.1D0
/
&disk_configure
  a_disk%star_luminosity_in_Lsun   = 1D0 ! Not used for montecarlo; only for xray lumi.
  a_disk%star_mass_in_Msun         = 0.5D0
  a_disk%star_radius_in_Rsun       = 2.0D0
  a_disk%star_temperature          = 4D3
  !
  a_disk%ratio_uv2total            = 1D-2  ! Not used because this ratio is calcualted from the stellar spectrum.
  a_disk%ratio_lyman2uv            = 0.1D0 ! Not used.
  a_disk%ratio_xray2total          = 1D-4  ! In use, for heatin.
  a_disk%geometric_factor_UV       = 1D-2  ! Not used.
  a_disk%geometric_factor_Xray     = 1D0  ! In use.
  !
  a_disk%backup_src                = .true. !
  a_disk%backup_src_cmd            = 'find src/*.f90 src/*.f src/makefile inp/*dat | cpio -pdm '
  !
  a_disk%dust2gas_mass_bg          = 1D-4 ! minimum dust2gas mass ratio
  !
  a_disk%andrews_gas%useNumDens    = .true.  ! Gas distribution
  a_disk%andrews_gas%Md            = 0.01D0  ! Total mass in Msun
  a_disk%andrews_gas%rc            = 100D0  ! Boundary
  a_disk%andrews_gas%hc            = 10D0  ! Scale height at boundary
  a_disk%andrews_gas%gam           = 1.0D0  ! Power index
  a_disk%andrews_gas%psi           = 1.0D0  ! 
  !
  a_disk%ndustcompo                = 2  ! Number of dust components
  !
  a_disk%dustcompo(1)%itype        = 1  ! Dust mixture type to use
  a_disk%dustcompo(1)%mrn%rmin     = 1D0  ! Min radius
  a_disk%dustcompo(1)%mrn%rmax     = 10D0  ! Max radius
  a_disk%dustcompo(1)%mrn%n        = 3.5D0  ! Power index
  a_disk%dustcompo(1)%andrews%useNumDens = .false.  ! Use mass density insteady of number density
  a_disk%dustcompo(1)%andrews%Md         = 0.01D-2
  a_disk%dustcompo(1)%andrews%rc         = 100D0
  a_disk%dustcompo(1)%andrews%hc         = 10D0
  a_disk%dustcompo(1)%andrews%gam        = 1.0D0
  a_disk%dustcompo(1)%andrews%psi        = 1.0D0
  !
  a_disk%dustcompo(2)%itype        = 1  ! Dust mixture type to use
  a_disk%dustcompo(2)%mrn%rmin     = 0.01D0  ! Min radius
  a_disk%dustcompo(2)%mrn%rmax     = 1D0  ! Max radius
  a_disk%dustcompo(2)%mrn%n        = 3.5D0  ! Power index
  a_disk%dustcompo(2)%andrews%useNumDens = .false.  ! Use mass density insteady of number density
  a_disk%dustcompo(2)%andrews%Md         = 0.01D-4
  a_disk%dustcompo(2)%andrews%rc         = 100D0
  a_disk%dustcompo(2)%andrews%hc         = 10D0
  a_disk%dustcompo(2)%andrews%gam        = 1.0D0
  a_disk%dustcompo(2)%andrews%psi        = 1.0D0
/
&mole_line_configure
  mole_line_conf%dirname_mol_data  = './transitions/'
  mole_line_conf%fname_mol_data    = 'oh2o@rovib.dat'
  mole_line_conf%freq_min          = 1D2
  mole_line_conf%freq_max          = 2D3
/
&cell_configure
  cell_params_ini%omega_albedo              = 0.5D0  ! Dust albedo, only for chemistry
  cell_params_ini%UV_G0_factor_background   = 1.0D0  ! ISM UV
  cell_params_ini%zeta_cosmicray_H2         = 1.36D-17  ! Cosmic ray intensity
  cell_params_ini%GrainMaterialDensity_CGS  = 2D0  ! Density of dust material
  cell_params_ini%MeanMolWeight             = 1.4D0
  cell_params_ini%alpha_viscosity           = 0.00D0
/
&analyse_configure
  ! Do chemical analysis for some species at some locations
  a_disk_ana_params%do_analyse                      = .false.
  a_disk_ana_params%analyse_points_inp_dir          = './inp/'
  a_disk_ana_params%file_list_analyse_points        = 'points_to_analyse.dat'
  a_disk_ana_params%file_list_analyse_species       = 'Species_to_analyse.dat'
  a_disk_ana_params%file_analyse_res_ele            = 'elemental_reservoir.dat'
  a_disk_ana_params%file_analyse_res_contri         = 'contributions.dat'
/
&iteration_configure
  a_disk_iter_params%n_iter                         = 16
  a_disk_iter_params%nlocal_iter                    = 4
  a_disk_iter_params%rtol_T                         = 0.001D0  ! Not used
  a_disk_iter_params%atol_T                         = 1D0  ! Not used
  a_disk_iter_params%rtol_abun                      = 0.2D0  ! For checking convergency of a cell
  a_disk_iter_params%atol_abun                      = 1D-12
  a_disk_iter_params%converged_cell_percentage_stop = 0.95  ! Stop if so many cells have converged.
  a_disk_iter_params%filename_list_check_refine     = 'species_check_refine.dat'  ! Do refinement based on species in this file.
  a_disk_iter_params%threshold_ratio_refine         = 10D0  ! Do refinement if the gradient (ratio) is so large
  a_disk_iter_params%nMax_refine                    = -100  ! Max times of refinments
  a_disk_iter_params%redo_montecarlo                = .true.  ! Redo Monte Carlo after each full chemcial run.
  a_disk_iter_params%flag_save_rates                = .false.  ! Whether save the calculated rates.
  a_disk_iter_params%flag_shortcut_ini              = .false.  ! Whether use short-cut initial condition
  a_disk_iter_params%do_line_transfer               = .true.
  a_disk_iter_params%iter_files_dir                 = './res/testx/'
/
!-Notes------------------------------------------------------------------
! 1. Extreme dust settling.
! 2. Large grain size.
! 3. Xray with Ncol2star.
! 4. Larger inner boundary.
! 5. With even smaller cells.
